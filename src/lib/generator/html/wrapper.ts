import timestamp from 'lib/utils/timestamp';

import frame from './frame';
import { fontList } from '../styleProps';

import css from 'lib/generator/css/index';
import js from 'lib/generator/js/index';
import widthRange from 'lib/generator/widthRange';

export default ({ config, assets, variables }) => {
	const containerID = `${config.name}-box`;

	const frameCSS = assets
		.map(
			({ node, filename }) =>
				frame({
					node,
					filename,
					widthRange: widthRange(assets),
					alt: config.alt,
					config,
					variables
				}).css
		)
		.join('\n\n');

	const assetsHTML = assets
		.map(
			({ node, filename }) =>
				frame({
					node,
					filename,
					widthRange: widthRange(assets),
					alt: config.alt,
					config,
					variables
				}).html
		)
		.join('\n\n');

	const html = `<!-- Generated by figma2html on ${timestamp()} -->
	<style type='text/css'>${css.page({ id: containerID, config, css: frameCSS })}</style>
	<div id="${containerID}" class="figma2html">${assetsHTML}</div>
	${config.includeResizer ? js.resizer(containerID, false) : ''}
	${config.includeGoogleFonts && !!fontList.length ? js.fonts(fontList) : ''}
	${config.customScript ? config.customScript : ''}
	<!-- End figma2html generated content - ${timestamp()} -->`;

	return html;
};
